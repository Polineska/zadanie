У меня не получилось вставить алгоритм сюда.
выделено, где какой вид алгоритма использован.

логика попробовать исправлена